#!/usr/bin/env bash

PLATFORM="unknown"
if [[ "$(uname -v)" == *"Ubuntu"* ]]; then
   PLATFORM='ubuntu'
fi
if [[ "$(uname -v)" == *"Darwin"* ]]; then
   PLATFORM='mac'
fi
if [ "$(grep -c Raspbian /etc/os-release)" -ge 1 ]; then
   PLATFORM='raspbian'
fi

install_package () {
  if [[ "$(uname -v)" == *"Ubuntu"* ]]; then
    sudo apt-get -qq -o "DPkg::Lock::Timeout=180" install $1
  fi
  if [[ "$PLATFORM" == "raspbian" ]]; then
    sudo apt-get -qq -o "DPkg::Lock::Timeout=180" install $1
  fi
  if [[ "$PLATFORM" == "mac" ]]; then
    brew install -q $1 
  fi
}

remove_package () {
  if [[ "$(uname -v)" == *"Ubuntu"* ]]; then
    sudo apt-get -qq -o "DPkg::Lock::Timeout=180" remove $1
  fi
  if [[ "$PLATFORM" == "raspbian" ]]; then
    sudo apt-get -qq -o "DPkg::Lock::Timeout=180" remove $1
  fi
  if [[ "$PLATFORM" == "mac" ]]; then
    brew uninstall -q $1
  fi
}

update_packages () {
  if [[ "$(uname -v)" == *"Ubuntu"* ]]; then
    sudo apt-get -qq -o "DPkg::Lock::Timeout=180" update > /dev/null
  fi
  if [[ "$PLATFORM" == "raspbian" ]]; then
    sudo apt-get -qq -o "DPkg::Lock::Timeout=180" update > /dev/null
  fi
  if [[ "$PLATFORM" == "mac" ]]; then
    brew update -q
  fi
}

upgrade_packages () {
  if [[ "$(uname -v)" == *"Ubuntu"* ]]; then
    sudo -E apt-get -qq -o "Dpkg::Options::=--force-confdef" -o "Dpkg::Options::=--force-confold" -o "DPkg::Lock::Timeout=180" upgrade > /dev/null
  fi
  if [[ "$PLATFORM" == "raspbian" ]]; then
    sudo -E apt-get -qq -o "Dpkg::Options::=--force-confdef" -o "Dpkg::Options::=--force-confold" -o "DPkg::Lock::Timeout=180" upgrade > /dev/null
  fi
  if [[ "$PLATFORM" == "mac" ]]; then
    brew upgrade -q
  fi
}
